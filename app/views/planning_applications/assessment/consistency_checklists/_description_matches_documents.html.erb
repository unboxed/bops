<%= form.govuk_radio_buttons_fieldset(
      :description_matches_documents,
      legend: {text: t(".does_the_description"), size: "s"}
    ) do %>
  <% if can_edit %>
    <%= form.govuk_radio_button(
          :description_matches_documents,
          :yes,
          label: {text: t(".yes")},
          link_errors: true,
          disabled: consistency_checklist&.open_description_change_requests?
        ) %>
    <%= form.govuk_radio_button(
          :description_matches_documents,
          :no,
          label: {text: t(".no")},
          checked: consistency_checklist&.default_description_matches_documents_to_no?
        ) do %>
      <% unless consistency_checklist.open_description_change_requests? %>
        <% check_description_slug = "check-and-validate/check-application-details/check-description" %>
        <% if local_assigns[:redirect_to] && planning_application.case_record&.find_task_by_slug_path(check_description_slug) %>
          <%= govuk_link_to t(".request_description_change"),
                task_path(
                  planning_application,
                  check_description_slug,
                  return_to: local_assigns[:redirect_to]
                ) %>
        <% else %>
          <%= govuk_link_to t(".request_description_change"),
                main_app.new_planning_application_validation_validation_request_path(
                  planning_application,
                  type: "description_change"
                ) %>
        <% end %>
      <% end %>
    <% end %>
  <% else %>
    <%= form.govuk_radio_button(
          :description_matches_documents,
          consistency_checklist&.description_matches_documents,
          label: {
            text: t(".#{consistency_checklist.description_matches_documents}")
          },
          disabled: true
        ) %>
  <% end %>
  <% unless planning_application.pre_application? %>
    <%= render(
          partial: "/planning_applications/assessment/consistency_checklists/description_change_validation_request",
          locals: {
            request: planning_application.description_change_validation_request,
            planning_application: planning_application,
            redirect_to: local_assigns[:redirect_to]
          }
        ) %>
  <% end %>
<% end %>
